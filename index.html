<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NoBrokerHood | AI Document Converter</title>
  <link rel="icon" href="https://www.nobrokerhood.com/favicon.ico">
  <style>
    body {
      font-family: "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #000000, #001a33);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      color: #f0f2f5;
    }

    .container {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      text-align: center;
      padding: 45px 40px;
      width: 90%;
      max-width: 520px;
      box-shadow: 0 4px 25px rgba(0, 0, 0, 0.5);
    }

    .logo {
      width: 190px;
      margin-bottom: 15px;
      filter: drop-shadow(0 0 6px rgba(0, 191, 255, 0.5));
    }

    h1 {
      color: #00bfff;
      margin-bottom: 12px;
    }

    p {
      color: #dcdcdc;
      margin-bottom: 20px;
    }

    input[type="file"] {
      border: 1px solid #00bfff;
      background: transparent;
      color: #fff;
      padding: 10px;
      border-radius: 8px;
      width: 100%;
      margin-bottom: 10px;
    }

    input[type="file"]::file-selector-button {
      background: #00bfff;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    input[type="file"]::file-selector-button:hover {
      background-color: #0099cc;
    }

    /* üü° Added hint text style */
    .hint {
      font-size: 13px;
      color: #ffcc00;
      margin-bottom: 20px;
      font-style: italic;
    }

    button {
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      margin: 8px;
      transition: 0.3s ease;
    }

    .primary-button {
      background-color: #00bfff;
    }

    .secondary-button {
      background-color: #1877f2;
    }

    .split-button {
      background-color: #ff9800;
    }

    button:hover {
      transform: scale(1.05);
    }

    #loader {
      display: none;
      margin-top: 20px;
    }

    .spinner {
      border: 4px solid #333;
      border-top: 4px solid #00bfff;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #status {
      margin-top: 15px;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://www.nobrokerhood.com/assets/images/logo-white.png" alt="NoBrokerHood Logo" class="logo">
    <h1>AI Document Converter</h1>
    <p>Upload your PDF or image (‚â§10 MB) for conversion or splitting.</p>

    <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png">

    <!-- üí° Added user-friendly hint -->
    <p class="hint">üí° If your PDF has more than 5 pages, please use the <b>Split PDF</b> option first.</p>

    <button onclick="processFile('template')" class="primary-button">Convert to CSV (Template)</button>
    <button onclick="processFile('excel')" class="secondary-button">Convert to Excel (As-Is)</button>
    <button onclick="splitPDF()" class="split-button">Split PDF (Large Files)</button>

    <div id="loader">
      <div class="spinner"></div>
      <p>Processing, please wait‚Ä¶</p>
    </div>

    <p id="status"></p>
  </div>

  <script>
    const BASE_URL = "https://pdftoexcel-846x.onrender.com";

    async function processFile(type) {
      const f = document.getElementById('fileInput').files[0];
      const status = document.getElementById('status');
      const loader = document.getElementById('loader');

      if (!f) {
        status.textContent = "Please select a file.";
        status.style.color = "#ff6666";
        return;
      }

      const fd = new FormData();
      fd.append('file', f);

      status.textContent = "";
      loader.style.display = 'block';

      let endpoint = type === 'template' ? '/process-document/' : '/export-to-excel/';
      let filename = type === 'template' ? 'converted_template.csv' : 'exported_data.xlsx';

      try {
        const res = await fetch(BASE_URL + endpoint, { method: 'POST', body: fd });
        if (res.ok) {
          const blob = await res.blob();
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = filename;
          a.click();
          URL.revokeObjectURL(url);
          status.textContent = "‚úÖ Success! File is downloading.";
          status.style.color = "#00ff99";
        } else {
          const err = await res.json();
          status.textContent = `‚ö†Ô∏è ${err.detail}`;
          status.style.color = "#ff6666";
        }
      } catch (e) {
        status.textContent = "‚ùå Server error. Please try again.";
        status.style.color = "#ff6666";
      }

      loader.style.display = 'none';
    }

    async function splitPDF() {
      const f = document.getElementById('fileInput').files[0];
      const status = document.getElementById('status');
      const loader = document.getElementById('loader');

      if (!f) {
        status.textContent = "Select a PDF file first.";
        status.style.color = "#ff6666";
        return;
      }

      if (!f.name.endsWith('.pdf')) {
        status.textContent = "Only PDF files can be split.";
        status.style.color = "#ff6666";
        return;
      }

      const fd = new FormData();
      fd.append('file', f);

      status.textContent = "";
      loader.style.display = 'block';

      try {
        const res = await fetch(BASE_URL + '/split-pdf/', { method: 'POST', body: fd });
        if (res.ok) {
          const blob = await res.blob();
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'split_parts.zip';
          a.click();
          URL.revokeObjectURL(url);
          status.textContent = "‚úÖ PDF successfully split.";
          status.style.color = "#00ff99";
        } else {
          const err = await res.json();
          status.textContent = `‚ö†Ô∏è ${err.detail}`;
          status.style.color = "#ff6666";
        }
      } catch (e) {
        status.textContent = "‚ùå Error while splitting PDF.";
        status.style.color = "#ff6666";
      }

      loader.style.display = 'none';
    }
  </script>
</body>
</html>
